<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‹¤ì‹œê°„ ì»¨íŒ ëŒ€ê¸°ì—´</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    
    <style>
        body { font-family: 'Malgun Gothic', 'ë§‘ì€ ê³ ë”•', sans-serif; background-color: #f4f7f6; margin: 0; padding: 20px; display: flex; justify-content: center; }
        .container { background-color: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); width: 100%; max-width: 650px; }
        h2 { text-align: center; color: #333; margin-bottom: 20px; }
        .form-group { display: flex; gap: 10px; margin-bottom: 20px; }
        input { padding: 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; }
        input#name { width: 25%; }
        input#content { width: 60%; }
        .btn-submit { width: 15%; padding: 12px; background-color: #2b2d42; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; }
        .btn-submit:hover { background-color: #1a1b2e; }
        .queue-list { list-style: none; padding: 0; margin: 0; }
        .queue-item { background-color: #f8f9fa; border-left: 5px solid #8d99ae; padding: 15px; margin-bottom: 10px; border-radius: 6px; display: flex; justify-content: space-between; align-items: center; transition: all 0.3s ease; }
        
        @keyframes blinkWarning {
            0% { background-color: #fff3cd; border-left-color: #ffc107; box-shadow: 0 0 10px rgba(255, 193, 7, 0.5); }
            50% { background-color: #ffe69c; border-left-color: #fd7e14; box-shadow: 0 0 15px rgba(253, 126, 20, 0.8); }
            100% { background-color: #fff3cd; border-left-color: #ffc107; box-shadow: 0 0 10px rgba(255, 193, 7, 0.5); }
        }
        .queue-item.calling { animation: blinkWarning 1.5s infinite; }
        .queue-item.calling .queue-status { color: #d32f2f; font-weight: bold; }
        .queue-info { flex-grow: 1; }
        .queue-info strong { display: inline-block; width: 60px; color: #2b2d42; }
        .queue-time { font-size: 12px; color: #888; margin-top: 5px; display: block; }
        .action-buttons { display: flex; gap: 8px; }
        button { padding: 8px 12px; font-size: 13px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; }
        .btn-call { background-color: #ffb703; color: #023047; }
        .btn-call:hover { background-color: #fb8500; }
        .btn-done { background-color: #8d99ae; color: white; }
        .btn-done:hover { background-color: #717b8c; }
        .empty-msg { text-align: center; color: #888; padding: 20px; }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ“ ì‹¤ì‹œê°„ ëŒ€í‘œë‹˜ ì»¨íŒ ëŒ€ê¸°ì—´</h2>
    
    <form class="form-group" id="confirmForm">
        <input type="text" id="name" placeholder="ì´ë¦„" required>
        <input type="text" id="content" placeholder="ì˜ˆ: í˜œì›€ í‰ë©´ë„, ì´ì²œ ë°”ë””ì¦ˆ ìƒ˜í”Œë³´ë“œ ë“±" required>
        <button type="submit" class="btn-submit">ë“±ë¡</button>
    </form>

    <ul class="queue-list" id="queueList">
        </ul>
</div>

<script>
    // ğŸš¨ ì—¬ê¸°ì— 1ë‹¨ê³„ì—ì„œ ë³µì‚¬í•œ ë³¸ì¸ì˜ firebaseConfigë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”!
const firebaseConfig = {
  apiKey: "AIzaSyBZmxJUr5oaZttF7oIYJSEBb5RgjVQjInY",
  authDomain: "cofirm-board.firebaseapp.com",
  projectId: "cofirm-board",
  storageBucket: "cofirm-board.firebasestorage.app",
  messagingSenderId: "367825644618",
  appId: "1:367825644618:web:3f236c72c07d5347878ab3",
  measurementId: "G-N4QY18DHPX"
};


    // Firebase ì´ˆê¸°í™” (ì´ë¯¸ ì´ˆê¸°í™”ë˜ì—ˆëŠ”ì§€ í™•ì¸ í›„ ì‹¤í–‰)
    if (!firebase.apps.length) {
        firebase.initializeApp(firebaseConfig);
    }
    const db = firebase.database();
    const queueRef = db.ref('confirm_queue'); // ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥ ê³µê°„ ì´ë¦„

    const form = document.getElementById('confirmForm');
    const queueList = document.getElementById('queueList');

    // ğŸ’¡ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì‹¤ì‹œê°„ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™€ì„œ í™”ë©´ì— ê·¸ë¦¬ê¸°
    queueRef.on('value', (snapshot) => {
        queueList.innerHTML = '';
        const data = snapshot.val();
        
        if (!data) {
            queueList.innerHTML = '<li class="empty-msg">í˜„ì¬ ëŒ€ê¸° ì¤‘ì¸ ì»¨íŒì´ ì—†ìŠµë‹ˆë‹¤. â˜•</li>';
            return;
        }

        // ê³ ìœ  ID(í‚¤ê°’)ì™€ ë°ì´í„°ë¥¼ ë§¤ì¹­í•˜ì—¬ ë°°ì—´ë¡œ ë³€í™˜ í›„ ë Œë”ë§
        let index = 1;
        for (let key in data) {
            const item = data[key];
            const li = document.createElement('li');
            
            li.className = item.status === 'calling' ? 'queue-item calling' : 'queue-item';
            const statusText = item.status === 'calling' ? 'ğŸš¨ ëŒ€í‘œë‹˜ í˜¸ì¶œ ì¤‘!' : 'ëŒ€ê¸° ì¤‘';
            const callBtnText = item.status === 'calling' ? 'í˜¸ì¶œ ì·¨ì†Œ' : 'í˜¸ì¶œ (ëŒ€í‘œë‹˜)';

            li.innerHTML = `
                <div class="queue-info">
                    <span class="queue-number"><strong>#${index}</strong> ${item.name}</span>
                    <span class="queue-status" style="font-size: 12px; margin-left: 10px;">[${statusText}]</span><br>
                    <span style="display:inline-block; margin-top:5px;">${item.content}</span>
                    <span class="queue-time">${item.time} ì‹ ì²­</span>
                </div>
                <div class="action-buttons">
                    <button class="btn-call" onclick="toggleCall('${key}', '${item.status}')">${callBtnText}</button>
                    <button class="btn-done" onclick="completeConfirm('${key}')">ì™„ë£Œ</button>
                </div>
            `;
            queueList.appendChild(li);
            index++;
        }
    });

    // ë°ì´í„°ë² ì´ìŠ¤ì— ìƒˆë¡œìš´ ëŒ€ê¸° ë“±ë¡ (push)
    form.addEventListener('submit', function(e) {
        e.preventDefault();
        const nameInput = document.getElementById('name');
        const contentInput = document.getElementById('content');

        queueRef.push({
            name: nameInput.value,
            content: contentInput.value,
            time: new Date().toLocaleTimeString('ko-KR'),
            status: "waiting"
        });
        
        nameInput.value = '';
        contentInput.value = '';
    });

    // ë°ì´í„°ë² ì´ìŠ¤ ìƒíƒœ ì—…ë°ì´íŠ¸ (í˜¸ì¶œ / í˜¸ì¶œì·¨ì†Œ)
    window.toggleCall = function(key, currentStatus) {
        const newStatus = currentStatus === 'waiting' ? 'calling' : 'waiting';
        queueRef.child(key).update({ status: newStatus });
    }

    // ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ í•­ëª© ì‚­ì œ (ì»¨íŒ ì™„ë£Œ)
    window.completeConfirm = function(key) {
        queueRef.child(key).remove();
    }
</script>

</body>
</html>